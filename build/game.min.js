var Game={nextId:0,pieces:[],el:document.getElementById("room"),add:function(e){e.create(),null===e.id?(e.id=this.nextId,this.pieces[this.nextId]=e,this.nextId++):this.pieces[e.id]=e,this.show(e)},remove:function(e){this.el.removeChild(e.el),delete this.pieces[e.id]},hide:function(e){this.el.removeChild(e.el)},show:function(e){this.el.appendChild(this.pieces[e.id].el)},step:function(){for(var e=0,t=this.pieces.length;t>e;e++)this.pieces[e].step()}},TextBox={el:document.getElementById("text"),last:null,push:function(e){var t=document.createElement("div");t.innerHTML=e,t.className="mess",this.el.insertBefore(t,this.last),this.last=t}};TextBox.push('Wellcome to jarl <br> push "?" for instructions'),TextBox.push("You entered level 1");var Gamepiece={x:0,y:0,id:null,className:"fixed trans",create:function(){this.el=document.createElement("img"),this.el.className=this.el.className,this.el.src=this.src,this.step()},step:function(){var e=this.fliped?" fliped":"";this.el.style.left=this.x+"px",this.el.style.top=this.y+"px",this.el.className=this.className+e},move:function(e,t){this.x=e,this.y=t,this.step()},moveRel:function(e,t){this.x+=e,this.y+=t,this.step()},extend:function(e){var t=Object.create(this);for(var i in e)t[i]=e[i];return t}},Player=Gamepiece.extend({type:"player",src:"night.min.gif"});Game.add(Player);var Wall=Object.create(Gamepiece);Wall.setSprite("wall.min.gif"),Mousetrap.bind(["left","h"],function(){Player.fliped=!0,Player.moveRel(-32,0)},"keyup"),Mousetrap.bind(["right","l"],function(){Player.fliped=!1,Player.moveRel(32,0)},"keyup"),Mousetrap.bind(["up","k"],function(){Player.moveRel(0,-32)},"keyup"),Mousetrap.bind(["down","j"],function(){Player.moveRel(0,32)},"keyup"),Mousetrap.bind(["y"],function(){Player.fliped=!0,Player.moveRel(-32,-32)},"keyup"),Mousetrap.bind(["u"],function(){Player.fliped=!1,Player.moveRel(32,-32)},"keyup"),Mousetrap.bind(["n"],function(){Player.fliped=!0,Player.moveRel(-32,32)},"keyup"),Mousetrap.bind(["m"],function(){Player.fliped=!1,Player.moveRel(32,32)},"keyup"),Mousetrap.bind(["?"],function(){TextBox.push("Controls: <br />h - left <br />j - down <br />k - up <br />l - right <br />y - up-left <br />u - up-right <br />n - down-left <br />m - down-right <br />")},"keyup");